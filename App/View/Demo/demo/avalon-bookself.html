<% include html-header.html %>
<style>
    #book-list li{margin-bottom: 5px;}
</style>
<div class="container" ms-controller="container">
    <div class="row">
        <div class="col-sm-12">
            <form class="form-horizontal">
                <div class="form-group">
                    <label for="name" class="col-sm-2 control-label">图书名称</label>
                    <div class="col-sm-4">
                      <input type="text" ms-duplex="name" class="form-control" id="name" maxlength="20" placeholder="请输入图书名称">
                    </div>
                </div>
                <div class="form-group">
                    <label for="price" class="col-sm-2 control-label">图书价格</label>
                    <div class="col-sm-4">
                      <input type="text" class="form-control" ms-duplex="price"  id="price" maxlength="20" placeholder="请输入图书价格">
                    </div>
                </div>
                <div class="form-group">
                    <label for="publisher" class="col-sm-2 control-label">出版社</label>
                    <div class="col-sm-4">
                      <input type="text" class="form-control" ms-duplex="publisher" id="publisher" maxlength="20" placeholder="请输入出版社">
                    </div>
                </div>
                <button id="add" type="button" ms-click="add" class="btn btn-default">添加</button>
            </form>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <ul id="book-list">
                <li class="item" ms-repeat="bookself">书名：{{el.name}}价格：{{el.price}}出版社：{{el.publisher}}<a href="javascript:void(0)" ms-click="remove" class="btn btn-danger" >删除</a></li>
            </ul>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="hfma" id="avalon图书管理系统">avalon图书管理系统</h1><p data-anchor-id="zmv0"><strong>总结：</strong>跟<a href="http://nicholasway.cn/demo/index/demoRoute.html?src=bookself" target="_blank">backbone-bookself</a>实现的功能相比，avalon的代码更加简洁，且js和html的耦合度更低</p><div class="md-section-divider"></div><h2 data-anchor-id="2vzz" id="源码">源码</h2><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="tuvu"><ol class="linenums"><li class="L0"><code><span class="pun">&lt;%</span><span class="pln"> include html</span><span class="pun">-</span><span class="pln">header</span><span class="pun">.</span><span class="pln">html %&gt;</span></code></li><li class="L1"><code><span class="tag">&lt;style&gt;</span></code></li><li class="L2"><code><span class="pln">    </span><span class="com">#book-list li{margin-bottom: 5px;}</span></code></li><li class="L3"><code><span class="tag">&lt;/style&gt;</span></code></li><li class="L4"><code><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"container"</span><span class="pln"> </span><span class="atn">ms-controller</span><span class="pun">=</span><span class="atv">"container"</span><span class="tag">&gt;</span></code></li><li class="L5"><code><span class="pln">    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"row"</span><span class="tag">&gt;</span></code></li><li class="L6"><code><span class="pln">        </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"col-sm-12"</span><span class="tag">&gt;</span></code></li><li class="L7"><code><span class="pln">            </span><span class="tag">&lt;form</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"form-horizontal"</span><span class="tag">&gt;</span></code></li><li class="L8"><code><span class="pln">                </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"form-group"</span><span class="tag">&gt;</span></code></li><li class="L9"><code><span class="pln">                    </span><span class="tag">&lt;label</span><span class="pln"> </span><span class="atn">for</span><span class="pun">=</span><span class="atv">"name"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"col-sm-2 control-label"</span><span class="tag">&gt;</span><span class="pln">图书名称</span><span class="tag">&lt;/label&gt;</span></code></li><li class="L0"><code><span class="pln">                    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"col-sm-4"</span><span class="tag">&gt;</span></code></li><li class="L1"><code><span class="pln">                      </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">ms-duplex</span><span class="pun">=</span><span class="atv">"name"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"form-control"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"name"</span><span class="pln"> </span><span class="atn">maxlength</span><span class="pun">=</span><span class="atv">"20"</span><span class="pln"> </span><span class="atn">placeholder</span><span class="pun">=</span><span class="atv">"请输入图书名称"</span><span class="tag">&gt;</span></code></li><li class="L2"><code><span class="pln">                    </span><span class="tag">&lt;/div&gt;</span></code></li><li class="L3"><code><span class="pln">                </span><span class="tag">&lt;/div&gt;</span></code></li><li class="L4"><code><span class="pln">                </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"form-group"</span><span class="tag">&gt;</span></code></li><li class="L5"><code><span class="pln">                    </span><span class="tag">&lt;label</span><span class="pln"> </span><span class="atn">for</span><span class="pun">=</span><span class="atv">"price"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"col-sm-2 control-label"</span><span class="tag">&gt;</span><span class="pln">图书价格</span><span class="tag">&lt;/label&gt;</span></code></li><li class="L6"><code><span class="pln">                    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"col-sm-4"</span><span class="tag">&gt;</span></code></li><li class="L7"><code><span class="pln">                      </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"form-control"</span><span class="pln"> </span><span class="atn">ms-duplex</span><span class="pun">=</span><span class="atv">"price"</span><span class="pln">  </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"price"</span><span class="pln"> </span><span class="atn">maxlength</span><span class="pun">=</span><span class="atv">"20"</span><span class="pln"> </span><span class="atn">placeholder</span><span class="pun">=</span><span class="atv">"请输入图书价格"</span><span class="tag">&gt;</span></code></li><li class="L8"><code><span class="pln">                    </span><span class="tag">&lt;/div&gt;</span></code></li><li class="L9"><code><span class="pln">                </span><span class="tag">&lt;/div&gt;</span></code></li><li class="L0"><code><span class="pln">                </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"form-group"</span><span class="tag">&gt;</span></code></li><li class="L1"><code><span class="pln">                    </span><span class="tag">&lt;label</span><span class="pln"> </span><span class="atn">for</span><span class="pun">=</span><span class="atv">"publisher"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"col-sm-2 control-label"</span><span class="tag">&gt;</span><span class="pln">出版社</span><span class="tag">&lt;/label&gt;</span></code></li><li class="L2"><code><span class="pln">                    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"col-sm-4"</span><span class="tag">&gt;</span></code></li><li class="L3"><code><span class="pln">                      </span><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"form-control"</span><span class="pln"> </span><span class="atn">ms-duplex</span><span class="pun">=</span><span class="atv">"publisher"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"publisher"</span><span class="pln"> </span><span class="atn">maxlength</span><span class="pun">=</span><span class="atv">"20"</span><span class="pln"> </span><span class="atn">placeholder</span><span class="pun">=</span><span class="atv">"请输入出版社"</span><span class="tag">&gt;</span></code></li><li class="L4"><code><span class="pln">                    </span><span class="tag">&lt;/div&gt;</span></code></li><li class="L5"><code><span class="pln">                </span><span class="tag">&lt;/div&gt;</span></code></li><li class="L6"><code><span class="pln">                </span><span class="tag">&lt;button</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"add"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"button"</span><span class="pln"> </span><span class="atn">ms-click</span><span class="pun">=</span><span class="atv">"add"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"btn btn-default"</span><span class="tag">&gt;</span><span class="pln">添加</span><span class="tag">&lt;/button&gt;</span></code></li><li class="L7"><code><span class="pln">            </span><span class="tag">&lt;/form&gt;</span></code></li><li class="L8"><code><span class="pln">        </span><span class="tag">&lt;/div&gt;</span></code></li><li class="L9"><code><span class="pln">    </span><span class="tag">&lt;/div&gt;</span></code></li><li class="L0"><code><span class="pln">    </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"row"</span><span class="tag">&gt;</span></code></li><li class="L1"><code><span class="pln">        </span><span class="tag">&lt;div</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"col-sm-12"</span><span class="tag">&gt;</span></code></li><li class="L2"><code><span class="pln">            </span><span class="tag">&lt;ul</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"book-list"</span><span class="tag">&gt;</span></code></li><li class="L3"><code><span class="pln">                </span><span class="tag">&lt;li</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"item"</span><span class="pln"> </span><span class="atn">ms-repeat</span><span class="pun">=</span><span class="atv">"bookself"</span><span class="tag">&gt;</span><span class="pln">书名：{{el.name}}价格：{{el.price}}出版社：{{el.publisher}}</span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"javascript:void(0)"</span><span class="pln"> </span><span class="atn">ms-click</span><span class="pun">=</span><span class="atv">"remove"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"btn btn-danger"</span><span class="pln"> </span><span class="tag">&gt;</span><span class="pln">删除</span><span class="tag">&lt;/a&gt;&lt;/li&gt;</span></code></li><li class="L4"><code><span class="pln">            </span><span class="tag">&lt;/ul&gt;</span></code></li><li class="L5"><code><span class="pln">        </span><span class="tag">&lt;/div&gt;</span></code></li><li class="L6"><code><span class="pln">    </span><span class="tag">&lt;/div&gt;</span></code></li><li class="L7"><code><span class="tag">&lt;/div&gt;</span></code></li><li class="L8"><code><span class="pun">&lt;%</span><span class="pln"> include </span><span class="pun">../../</span><span class="typ">Home</span><span class="pun">/</span><span class="pln">footer</span><span class="pun">.</span><span class="pln">html %&gt;</span></code></li><li class="L9"><code><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/javascript"</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"/resource/js/jquery.min.js"</span><span class="tag">&gt;&lt;/script&gt;</span></code></li><li class="L0"><code><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/javascript"</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"/resource/js/avalon.js"</span><span class="tag">&gt;&lt;/script&gt;</span></code></li><li class="L1"><code><span class="tag">&lt;script</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/javascript"</span><span class="tag">&gt;</span></code></li><li class="L2"><code><span class="pln">    </span><span class="com">////sublime 将多行代码合并一行 ctrl+j</span></code></li><li class="L3"><code><span class="pln">    $</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(){</span></code></li><li class="L4"><code><span class="pln">        </span><span class="kwd">var</span><span class="pln"> model </span><span class="pun">=</span><span class="pln"> avalon</span><span class="pun">.</span><span class="pln">define</span><span class="pun">({</span></code></li><li class="L5"><code><span class="pln">            $id</span><span class="pun">:</span><span class="str">"container"</span><span class="pun">,</span></code></li><li class="L6"><code><span class="pln">            name</span><span class="pun">:</span><span class="str">""</span><span class="pun">,</span></code></li><li class="L7"><code><span class="pln">            price</span><span class="pun">:</span><span class="str">""</span><span class="pun">,</span></code></li><li class="L8"><code><span class="pln">            publisher</span><span class="pun">:</span><span class="str">""</span><span class="pun">,</span></code></li><li class="L9"><code><span class="pln">            bookself</span><span class="pun">:[],</span></code></li><li class="L0"><code><span class="pln">            add</span><span class="pun">:</span><span class="kwd">function</span><span class="pun">(){</span></code></li><li class="L1"><code><span class="pln">                </span><span class="kwd">var</span><span class="pln"> book </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">name</span><span class="pun">:</span><span class="pln">model</span><span class="pun">.</span><span class="pln">name</span><span class="pun">,</span><span class="pln">price</span><span class="pun">:</span><span class="pln">model</span><span class="pun">.</span><span class="pln">price</span><span class="pun">,</span><span class="pln">publisher</span><span class="pun">:</span><span class="pln">model</span><span class="pun">.</span><span class="pln">publisher</span><span class="pun">};</span></code></li><li class="L2"><code><span class="pln">                model</span><span class="pun">.</span><span class="pln">name</span><span class="pun">=</span><span class="str">""</span><span class="pun">;</span></code></li><li class="L3"><code><span class="pln">                model</span><span class="pun">.</span><span class="pln">price</span><span class="pun">=</span><span class="str">""</span><span class="pun">;</span></code></li><li class="L4"><code><span class="pln">                model</span><span class="pun">.</span><span class="pln">publisher</span><span class="pun">=</span><span class="str">""</span><span class="pun">;</span></code></li><li class="L5"><code><span class="pln">                model</span><span class="pun">.</span><span class="pln">bookself</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">book</span><span class="pun">);</span></code></li><li class="L6"><code><span class="pln">            </span><span class="pun">},</span></code></li><li class="L7"><code><span class="pln">            remove</span><span class="pun">:</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">e</span><span class="pun">){</span></code></li><li class="L8"><code><span class="pln">                $</span><span class="pun">(</span><span class="pln">e</span><span class="pun">.</span><span class="pln">target</span><span class="pun">).</span><span class="pln">parent</span><span class="pun">(</span><span class="str">"li"</span><span class="pun">).</span><span class="pln">remove</span><span class="pun">();</span></code></li><li class="L9"><code><span class="pln">            </span><span class="pun">}</span></code></li><li class="L0"><code><span class="pln">        </span><span class="pun">});</span></code></li><li class="L1"><code><span class="pln">        $</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">"/resource/data/books.json"</span><span class="pun">,</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">data</span><span class="pun">){</span></code></li><li class="L2"><code><span class="pln">            model</span><span class="pun">.</span><span class="pln">bookself </span><span class="pun">=</span><span class="pln"> data</span><span class="pun">;</span></code></li><li class="L3"><code><span class="pln">        </span><span class="pun">});</span></code></li><li class="L4"><code><span class="pln">    </span><span class="pun">});</span></code></li><li class="L5"><code><span class="tag">&lt;/script&gt;</span></code></li></ol></pre><blockquote data-anchor-id="md0e" class="white-blockquote">
  <p>参考 <br>
  <a href="http://avalonjs.github.io/" target="_blank">avalon</a> <br>
  <a href="http://www.cnblogs.com/rubylouvre/p/3181291.html" target="_blank">avalonjs 入门教程</a> <br>
  <a href="http://www.html-js.com/article/column/234?page=2" target="_blank">avalon学习教程</a></p>
</blockquote></div>
        </div>
    </div>
</div>
<% include ../../Home/footer.html %>
<script type="text/javascript" src="/resource/js/jquery.min.js"></script>
<script type="text/javascript" src="/resource/js/avalon.js"></script>
<script type="text/javascript">
    ////sublime 将多行代码合并一行 ctrl+j
    $(function(){
        var model = avalon.define({
            $id:"container",
            name:"",
            price:"",
            publisher:"",
            bookself:[],
            add:function(){
                var book = {name:model.name,price:model.price,publisher:model.publisher};
                model.name="";
                model.price="";
                model.publisher="";
                model.bookself.push(book);
            },
            remove:function(e){
                $(e.target).parent("li").remove();
            }
        });
        $.get("/resource/data/books.json",function(data){
            model.bookself = data;
        });
    });
</script>